"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}!function(e){function t(e){if(e!==r)throw TypeError("Invalid constructor")}function n(e,t,n){if(e!==r)throw TypeError("Invalid constructor");this._name=t,this._db=n}var r=Object.create(null),i="$SimpleDB$",a="store";t.prototype={open:function(e){return new Promise(function(t,o){var s=indexedDB.open(i+e);s.onupgradeneeded=function(){var e=s.result;e.createObjectStore(a)},s.onsuccess=function(){var i=s.result;t(new n(r,e,i))},s.onerror=function(){o(s.error)}})},"delete":function(e){return new Promise(function(t,n){var r=indexedDB.deleteDatabase(i+e);r.onsuccess=function(){t(void 0)},r.onerror=function(){n(r.error)}})}},n.cmp=indexedDB.cmp,n.prototype={get name(){return this._name},get:function(e){var t=this;return new Promise(function(n,r){var i=t._db.transaction(a,"readwrite"),o=i.objectStore(a),s=o.get(e);i.oncomplete=function(){n(s.result)},i.onabort=function(){r(i.error)}})},set:function(e,t){var n=this;return new Promise(function(r,i){var o=n._db.transaction(a,"readwrite"),s=o.objectStore(a);s.put(t,e);o.oncomplete=function(){r(void 0)},o.onabort=function(){i(o.error)}})},"delete":function(e){var t=this;return new Promise(function(n,r){var i=t._db.transaction(a,"readwrite"),o=i.objectStore(a);o["delete"](e);i.oncomplete=function(){n(void 0)},i.onabort=function(){r(i.error)}})},clear:function(){var e=this;return new Promise(function(t,n){var r=e._db.transaction(a,"readwrite"),i=r.objectStore(a);i.clear();r.oncomplete=function(){t(void 0)},r.onabort=function(){n(r.error)}})},forEach:function(e,t){var n=this;return new Promise(function(r,i){t=t||{};var o=n._db.transaction(a,"readwrite"),s=o.objectStore(a),c=s.openCursor(t.range,"reverse"===t.direction?"prev":"next");c.onsuccess=function(){var t=c.result;if(t)try{var n=e(t.key,t.value);n||t["continue"]()}catch(r){o.abort()}},o.oncomplete=function(){r(void 0)},o.onabort=function(){i(o.error)}})},getMany:function(e){var t=this;return new Promise(function(n,r){var i=t._db.transaction(a,"readwrite"),o=i.objectStore(a),s=[],c=!0,u=!1,l=void 0;try{for(var d,f=e[Symbol.iterator]();!(c=(d=f.next()).done);c=!0){var h=d.value;o.get(h).onsuccess(function(e){s.push(e)})}}catch(p){u=!0,l=p}finally{try{!c&&f["return"]&&f["return"]()}finally{if(u)throw l}}i.oncomplete=function(){n(s)},i.onabort=function(){r(i.error)}})},setMany:function(e){var t=this;return new Promise(function(n,r){var i=t._db.transaction(a,"readwrite"),o=i.objectStore(a),s=!0,c=!1,u=void 0;try{for(var l,d=e[Symbol.iterator]();!(s=(l=d.next()).done);s=!0){var f=l.value;o.put(f.value,f.key)}}catch(h){c=!0,u=h}finally{try{!s&&d["return"]&&d["return"]()}finally{if(c)throw u}}i.oncomplete=function(){n(void 0)},i.onabort=function(){r(i.error)}})},deleteMany:function(e){var t=this;return new Promise(function(n,r){var i=t._db.transaction(a,"readwrite"),o=i.objectStore(a),s=!0,c=!1,u=void 0;try{for(var l,d=e[Symbol.iterator]();!(s=(l=d.next()).done);s=!0){var f=l.value;o["delete"](f)}}catch(h){c=!0,u=h}finally{try{!s&&d["return"]&&d["return"]()}finally{if(c)throw u}}i.oncomplete=function(){n(void 0)},i.onabort=function(){r(i.error)}})}},e.simpleDB=new t(r),e.SimpleDBKeyRange=IDBKeyRange}(self),window.IOWA=window.IOWA||{},window.debugLog=function(e){"prod"!==window.ENV&&console.log.apply(console,arguments)},IOWA.Util=IOWA.Util||function(){function e(){var e,t,n=new Promise(function(n,r){e=n,t=r});return{promise:n,resolve:e,reject:t}}function t(){return/(iPhone|iPad|iPod)/gi.test(navigator.platform)}function n(){return/Android/gi.test(navigator.userAgent)}function r(){var e=navigator.userAgent;return/Safari/gi.test(e)&&!/Chrome/gi.test(e)}function i(){var e=navigator.userAgent;return/Trident/gi.test(e)}function a(){return/Edge/i.test(navigator.userAgent)}function o(){var e=navigator.userAgent;return/Firefox/gi.test(e)}function s(){return"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch}function c(e){var t=document.documentElement.querySelector('meta[name="theme-color"]');t&&(t.content=e)}function u(){var e=location.href.replace(location.hash,"");return e.substring(0,e.lastIndexOf("/")+1)}function l(e){if(window.location.search){var t=new RegExp(e+"=([^&]*)").exec(window.location.search.substring(1));if(t)return decodeURIComponent(t[1])}}function d(e,t){"?"===e[0]&&(e=e.substring(1));for(var n=e.split("&"),r=[],i=0;i<n.length;i++){var a=n[i].split("=");a[0]!==t&&r.push(n[i])}return e=r.join("&"),e.length>0&&(e="?"+e),e}function f(e,t,n){return e=d(e,t),""===e&&(e="?"),e.length>1&&(e+="&"),e+t+"="+encodeURIComponent(n)}function h(e){var t="https://www.googleapis.com/urlshortener/v1/url",n="AIzaSyBRMm_PwR1cfjT_yLxBiV9PDrwZPRIRLxg",r=t+"?key="+n;return new Promise(function(t,n){var i=new XMLHttpRequest;i.open("POST",r,!0),i.setRequestHeader("Content-Type","application/json; charset=utf-8"),i.onloadend=function(){if(200===this.status)try{var r=JSON.parse(this.response);t(r.id)}catch(i){n("Parsing URL Shortener result failed.")}else t(e)},i.send(JSON.stringify({longUrl:e}))})}var p=function(e){var t=e&&"string"==typeof e.stack?e.stack.slice(-500):"Unknown Location";IOWA.Analytics.trackError(t,e)},m=function(e,t){for(var n=Polymer.dom(e).path,r=null,i=0;i<n.length;++i){var a=n[i];if(a.localName===t){r=a;break}}return r},v=function(){if(window.chrome&&window.chrome.loadTimes){var e=window.chrome.loadTimes(),t=1e3*(e.firstPaintTime-e.startLoadTime);return Math.round(t)}if("performance"in window){var n=window.performance.timing;if(n.msFirstPaint&&0!==n.navigationStart)return n.msFirstPaint-n.navigationStart}return null};return{createDeferred:e,isFF:o,isIE:i,isEdge:a,isIOS:t,isAndroid:n,isSafari:r,isTouchScreen:s,setMetaThemeColor:c,supportsHTMLImports:"import"in document.createElement("link"),shortenURL:h,getFPIfSupported:v,getURLParameter:l,getStaticBaseURL:u,setSearchParam:f,getEventSender:m,removeSearchParam:d,reportError:p}}(),window.IOWA=window.IOWA||{},IOWA.Analytics=IOWA.Analytics||function(e){function t(){this.initTrackerReadyState(),this.trackPageView(),this.trackPerfEvent("HTMLImportsLoaded","Polymer"),this.trackPerfEvent("WebComponentsReady","Polymer"),this.trackOnlineStatus(),this.trackNotificationPermission(),this.trackServiceWorkerControlled();var t=e.location.search.match(/utm_error=([^&]+)/);t&&this.trackError("notification",decodeURIComponent(t[1])),this.startTimes_={}}return t.prototype.POLYMER_ANALYTICS_TIMEOUT_=6e4,t.prototype.READY_STATE_TIMEOUT_=5e3,t.prototype.customDimensions={SIGNED_IN:"dimension1",ONLINE:"dimension2",SERVICE_WORKER_STATUS:"dimension3",NOTIFICATION_PERMISSION:"dimension4"},t.prototype.initTrackerReadyState=function(){this.readyState_=IOWA.Util.createDeferred(),setTimeout(this.readyState_.resolve.bind(this),this.READY_STATE_TIMEOUT_)},t.prototype.updateTracker=function(e,t){ga(function(n){ga("set",e,t);var r=Object.keys(this.customDimensions);r.every(function(e){return void 0!==n.get(this.customDimensions[e])}.bind(this))&&this.readyState_.resolve()}.bind(this))},t.prototype.waitForTrackerReady=function(){return this.readyState_.promise},t.prototype.trackPageView=function(e,t){this.waitForTrackerReady().then(function(){e&&ga("set","page",e),ga("send","pageview",{hitCallback:t})})},t.prototype.trackPerf=function(e,t,n,r,i,a){this.waitForTrackerReady().then(function(){null!==i&&n>i&&(t+=" - outliers"),ga("send","timing",e,t,parseInt(n,10),r,a)})},t.prototype.trackEvent=function(e,t,n,r,i){this.waitForTrackerReady().then(function(){ga("send",{hitType:"event",eventCategory:e,eventAction:t,eventLabel:n,eventValue:r,hitCallback:i})})},t.prototype.trackError=function(e,t){this.waitForTrackerReady().then(function(){ga("send","event","error",e,String(t))})},t.prototype.trackSocial=function(e,t,n){this.waitForTrackerReady().then(function(){ga("send","social",e,t,n)})},t.prototype.trackPerfEvent=function(t,n){if(e.performance&&e.performance.getEntriesByName){var r=performance.getEntriesByName(t,"mark");if(r.length){var i=r[0].startTime;debugLog(t,"@",i),this.trackPerf(n,t,i,null,this.POLYMER_ANALYTICS_TIMEOUT_)}else document.addEventListener(t,this.trackPerfEvent.bind(this,t,n))}},t.prototype.timeStart=function(e,t,n){var r=this.startTimes_[e]||(this.startTimes_[e]={});r[t]=n},t.prototype.timeEnd=function(e,t,n,r,i){var a=this.startTimes_[e];if(a){var o=a[t];null!==o&&(this.trackPerf(e,t,n-o,r,i),a[t]=null)}},t.prototype.trackOnlineStatus=function(){this.updateTracker(this.customDimensions.ONLINE,navigator.onLine);var e=function(e){this.updateTracker(this.customDimensions.ONLINE,navigator.onLine),this.trackEvent("network","change",e.type)}.bind(this);window.addEventListener("online",e),window.addEventListener("offline",e)},t.prototype.trackNotificationPermission=function(){var e=this.getNotificationPermission();this.updateTracker(this.customDimensions.NOTIFICATION_PERMISSION,e),this.trackEvent("notifications","startup",e),navigator.permissions&&navigator.permissions.query({name:"notifications"}).then(function(e){e.onchange=function(e){this.updateTracker(this.customDimensions.NOTIFICATION_PERMISSION,this.getNotificationPermission()),this.trackEvent("notifications","change",e.target.state)}.bind(this)}.bind(this))},t.prototype.trackServiceWorkerControlled=function(){var e=this.getServiceWorkerStatus();this.updateTracker(this.customDimensions.SERVICE_WORKER_STATUS,e),"unsupported"===e?this.trackEvent("serviceworker","supported",!1):(this.trackEvent("serviceworker","supported",!0),this.trackEvent("serviceworker","controlled","controlled"===e))},t.prototype.getServiceWorkerStatus=function(){return"serviceWorker"in navigator?navigator.serviceWorker.controller?"controlled":"supported":"unsupported"},t.prototype.getNotificationPermission=function(){return e.Notification?e.Notification.permission:"unsupported"},new t}(window),function(e){e.IOWA=e.IOWA||{}}(window),IOWA.PAGES={about:{hasBeenLoaded:!1,title:"About I/O"},attend:{defaultSubpage:"event",hasBeenLoaded:!1,selectedSubpage:"event",title:"Attending"},error_404:{hasBeenLoaded:!1,title:"404 Not Found"},error_500:{hasBeenLoaded:!1,title:"500 Internal Error"},extended:{hasBeenLoaded:!1,title:"I/O Extended"},faq:{hasBeenLoaded:!1,title:"FAQ"},form:{hasBeenLoaded:!1,title:"2016 I/O Extended event"},home:{hasBeenLoaded:!1,title:"Google I/O 2016"},registration:{hasBeenLoaded:!1,title:"Registration"},schedule:{defaultSubpage:"day1",hasBeenLoaded:!1,selectedSubpage:"day1",title:"Schedule"},upgrade:{hasBeenLoaded:!1,title:"Try a different browser"},videos:{hasBeenLoaded:!1,title:"Videos"},widget:{hasBeenLoaded:!1,title:"I/O Live Embed Widget"}},window.IOWA=window.IOWA||{},IOWA.Auth=IOWA.Auth||function(){function e(){if(IOWA.Elements.GoogleSignIn.auth2){var e=IOWA.Elements.GoogleSignIn.auth2.currentUser.get();if(e.isSignedIn())return e.getAuthResponse()}else if(window.gapi&&window.gapi.auth)return window.gapi.auth.getToken();return null}function t(e){var t=IOWA.Elements.Drawer.querySelector(".profilepic");t.src=e.picture,t.hidden=!1}function n(){var e=IOWA.Elements.Drawer.querySelector(".profilepic");e.hidden=!0;var t=IOWA.Elements.Nav.querySelector(".button-link");t.removeAttribute("disabled")}function r(t,n){return e()&&IOWA.IOFirebase.isAuthed()?Promise.resolve():n&&IOWA.Elements.Template.app.currentUser&&IOWA.Elements.Template.app.currentUser.id?Promise.resolve():new Promise(function(e){i.push(e),t&&IOWA.Elements.Toast.showMessage(t,null,"Sign in",function(){IOWA.Elements.GoogleSignIn.signIn()})})}var i=[];return document.addEventListener("signin-change",function(e){if(e.detail.user){var r=e.detail.user;IOWA.IOFirebase.auth(r.id,r.tokenResponse.access_token).then(function(){for(t(r);i.length;){var e=i.shift();e()}})}else n(),navigator.serviceWorker&&navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage("clear-cached-user-data"),IOWA.IOFirebase.unAuth()}),document.addEventListener("signin-fail",function(e){n(),e.detail.oneTimeCodeFail&&IOWA.Analytics.trackError("login","error",e.detail.error)}),{getTokenResponse:e,waitForSignedIn:r}}(),IOWA.PageAnimation=function(){function e(e,t){return t.fill="forwards",new KeyframeEffect(e,[{opacity:1},{opacity:0}],t)}function t(e,t){return t.fill="forwards",new KeyframeEffect(e,[{opacity:0},{opacity:1}],t)}function n(e){var t=e.classList.contains("active")?"":".active ",n=e.querySelector(t+".slide-up"),r=e.querySelector(t+".slide-up-delay"),i={transform:"translate(0, 0)",opacity:1},a={transform:"translate(0, "+y+")",opacity:0};return new GroupEffect([new KeyframeEffect(n,[i,a],b),new KeyframeEffect(r,[i,a],A)])}function r(e){var t=e.classList.contains("active")?"":".active ",n=e.querySelector(t+".slide-up"),r=e.querySelector(t+".slide-up-delay"),i={transform:"translate(0, "+y+")",opacity:0},a={transform:"translate(0, 0)",opacity:1};return new GroupEffect([new KeyframeEffect(n,[i,a],A),new KeyframeEffect(r,[i,a],b)])}function i(){var t=IOWA.Elements.Main.querySelector(".masthead-meta"),r=IOWA.Elements.Main.querySelector(".subpage__nav");return new GroupEffect([n(IOWA.Elements.Main),e(t,A),e(r,A),e(IOWA.Elements.Footer,{duration:0})])}function a(){return new GroupEffect([r(IOWA.Elements.Main),t(IOWA.Elements.Footer,b)])}function o(e){if(e){var n=document.querySelectorAll(".subpage__content");Array.prototype.forEach.call(n,function(e){e.style.display="none"}),e.style.display=""}var i=e?r(e):a(),o=IOWA.Elements.Main.querySelector(".masthead-meta"),s=IOWA.Elements.Main.querySelector(".subpage__nav");return new GroupEffect([i,t(o,A),t(s,A)],A)}function s(){var e=IOWA.Elements.Main.querySelector(".masthead-meta"),n=IOWA.Elements.Main.querySelector(".subpage__nav");return new GroupEffect([a(),t(e,A),t(n,A)],A)}function c(e){var t=e.style.transform,n=t?parseInt(t.split("(")[1].split(",")[0],10):0,r=e.querySelector(".item:last-of-type").getBoundingClientRect(),i=r.width,a=n+i;i>a&&(e.style.transform="translate3d("+a+"px, 0, 0)")}function u(e){var t=e.style.transform,n=t?parseInt(t.split("(")[1].split(",")[0],10):0,r=e.getBoundingClientRect().width,i=e.querySelector(".item:last-of-type").getBoundingClientRect(),a=i.right,o=i.width,s=n-o;a>r&&(e.style.transform="translate3d("+s+"px, 0, 0)")}function l(e,t){var n=document.timeline.play(e);t&&(n.onfinish=function(){var e=IOWA.Elements.Main.querySelector(".active .slide-up");e&&e.setAttribute("style","transform: none; opacity: 1");var n=IOWA.Elements.Main.querySelector(".active .slide-up-delay");n&&n.setAttribute("style","transform: none; opacity: 1"),this.cancel(),t()})}function d(){return new Promise(function(e){l(s(),e)})}function f(){return new Promise(function(e){l(i(),e)})}function h(t){return new Promise(function(r){l(new GroupEffect([n(t),e(IOWA.Elements.Footer,{duration:400})]),r)})}function p(e){return new Promise(function(n){l(new GroupEffect([r(e),t(IOWA.Elements.Footer,{duration:400})]),n)})}var m=300,v=200,g="cubic-bezier(0.4, 0, 0.2, 1)",y="100px",A={duration:m,easing:g,fill:"forwards"},b={duration:m,delay:v,easing:g,fill:"forwards"};return{elementFadeIn:t,elementFadeOut:e,pageFirstRender:o,play:l,playPageSlideOut:f,playPageSlideIn:d,playSectionSlideOut:h,playSectionSlideIn:p,shiftContentLeft:c,shiftContentRight:u}}(),IOWA.Elements=function(){function e(){var e=function t(){document.body.removeEventListener("page-select",t);var e=IOWA.Elements.LazyPages.selectedPage,n=IOWA.Router.parseUrl(window.location.href);e.selectedSubpage=n.subpage||e.selectedSubpage;var r=document.querySelector(".subpage-"+e.selectedSubpage);IOWA.PageAnimation.play(IOWA.PageAnimation.pageFirstRender(r),function(){IOWA.Elements.Template.fire("page-transition-done"),IOWA.ServiceWorkerRegistration.register()})};IOWA.Elements&&IOWA.Elements.LazyPages&&IOWA.Elements.LazyPages.selectedPage?e():document.body.addEventListener("page-select",e)}function t(){var e=document.querySelector(".io-main"),t=document.querySelector(".masthead"),n=t.querySelector("#navbar"),r=n.querySelector("paper-tabs"),i=document.querySelector("footer"),a=document.getElementById("toast"),o=document.getElementById("live-status"),s=document.querySelector("google-signin"),c=document.querySelector("lazy-pages");c.selected=IOWA.Elements.Template.selectedPage,IOWA.Elements.Drawer=IOWA.Elements.Template.$.appdrawer,IOWA.Elements.Masthead=t,IOWA.Elements.Main=e,IOWA.Elements.Nav=n,IOWA.Elements.NavPaperTabs=r,IOWA.Elements.Toast=a,IOWA.Elements.LiveStatus=o,IOWA.Elements.Footer=i,IOWA.Elements.GoogleSignIn=s,IOWA.Elements.LazyPages=c,IOWA.Elements.ScrollContainer=window,IOWA.Elements.Scroller=document.documentElement,IOWA.A11y.init()}function n(){var e=document.getElementById("t");e.app={},e.app.pageTransitionDone=!1,e.app.fullscreenVideoActive=!1,e.app.isIOS=IOWA.Util.isIOS(),e.app.isAndroid=IOWA.Util.isAndroid(),e.app.ANALYTICS_LINK_ATTR=r,e.app.scheduleData=null,e.app.savedSessions=[],e.app.watchedVideos=[],e.app.currentUser=null,e.app.showMySchedulHelp=!0,e.app.headerReveals=!0,e.pages=IOWA.PAGES,e.selectedPage=IOWA.Router.parseUrl(window.location.href).page,e._fabCrossFooterThreshold=null,e._fabBottom=null,IOWA.Util.setMetaThemeColor("#546E7A"),e.openSettings=function(e){var t=Polymer.dom(e).rootTarget.getAttribute(r);t&&IOWA.Analytics.trackEvent("link","click",t),IOWA.Elements.Nav.querySelector("paper-menu-button").open()},e.setSelectedPageToHome=function(){this.selectedPage="home"},e.backToTop=function(e){e.preventDefault(),Polymer.AppLayout.scroll({top:0,behavior:"smooth",target:IOWA.Elements.Scroller}),e.target.blur()},e.toggleDrawer=function(){this.$.appdrawer.toggle()},e.signIn=function(e){if(e){e.preventDefault();var t=Polymer.dom(e).rootTarget;t.hasAttribute(r)&&IOWA.Analytics.trackEvent("link","click",t.getAttribute(r))}IOWA.Elements.GoogleSignIn.signIn()},e.keyboardSignIn=function(e){13!==e.keyCode&&32!==e.keyCode||this.signIn()},e.signOut=function(e){if(e){e.preventDefault();var t=Polymer.dom(e).rootTarget;t.hasAttribute(r)&&IOWA.Analytics.trackEvent("link","click",t.getAttribute(r))}IOWA.Elements.GoogleSignIn.signOut()},e.keyboardSignOut=function(e){13!==e.keyCode&&32!==e.keyCode||this.signOut()},e.initFabScroll=function(){if(!this.app.isPhoneSize){this.$.fab.style.top="";var e=IOWA.Elements.ScrollContainer===window?IOWA.Elements.ScrollContainer.innerHeight:IOWA.Elements.ScrollContainer.scrollHeight,t=this.$.fab.getBoundingClientRect();this._fabBottom=parseInt(window.getComputedStyle(this.$.fab).bottom,10),this._fabCrossFooterThreshold=IOWA.Elements.Scroller.scrollHeight-e-t.height,this._setFabPosition(IOWA.Elements.Masthead._scrollTop),this.listen(IOWA.Elements.ScrollContainer,"scroll","_onContentScroll")}},e._setFabPosition=function(e){var t=10;return t>=e?(this.$.fab.classList.remove("active"),void this.debounce("updatefaba11y",function(){this.$.fabAnchor.setAttribute("tabindex",-1),this.$.fabAnchor.setAttribute("aria-hidden",!0)},500)):(this.$.fab.classList.add("active"),this.debounce("updatefaba11y",function(){this.$.fabAnchor.setAttribute("tabindex",0),this.$.fabAnchor.setAttribute("aria-hidden",!1)},500),void(this._fabCrossFooterThreshold<=e?this.$.fab.style.transform="translateY(-"+(e-this._fabCrossFooterThreshold)+"px)":this.$.fab.style.transform=""))},e._onContentScroll=function(){var e=IOWA.Elements.Masthead._scrollTop;this.debounce("mainscroll",function(){0===e?this.$.navbar.classList.remove("scrolled"):this.$.navbar.classList.add("scrolled"),IOWA.Elements.NavPaperTabs.updateStyles()},25),window.requestAnimationFrame(function(){this._setFabPosition(e)}.bind(this))},e._isPage=function(e,t){return e===t},e.closeDrawer=function(){this.$.appdrawer&&this.$.appdrawer.close()},e._onClearFilters=function(e){e.stopPropagation();var t=IOWA.Elements.LazyPages.selectedPage;t.clearFilters()},e.domStampedPromise=new Promise(function(t){e.addEventListener("dom-change",t)}),e.domStampedPromise.then(t),e.addEventListener("page-transition-done",function(){this.set("app.pageTransitionDone",!0),IOWA.Elements.NavPaperTabs.style.pointerEvents="",this.initFabScroll()}),e.addEventListener("page-transition-start",function(){this.set("app.pageTransitionDone",!1),IOWA.Elements.NavPaperTabs.style.pointerEvents="none"}),IOWA.Elements.Template=e}var r="data-track-link";return{init:n,onElementsBundleLoaded:e}}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();window.IOWA=window.IOWA||{};var IOFirebase=function(){function e(){_classCallCheck(this,e),this.firebaseRef=null,this.clockOffset=0,this.authCallbacks=[],"undefined"!=typeof document.hidden&&document.addEventListener("visibilitychange",function(){return document.hidden?e.goOffline():e.goOnline()})}return _createClass(e,[{key:"auth",value:function(t,n){var r=this,i=e._selectShard(t);return debugLog("Chose the following Firebase Database Shard:",i),this.firebaseRef=new Firebase(i),this._setClockOffset().then(function(){return r.firebaseRef.authWithOAuthToken("google",n)}).then(function(){return IOWA.Analytics.trackEvent("login","success",i),debugLog("Authenticated successfully to Firebase shard",i),r.authCallbacks.forEach(function(e){return e()}),r._bumpLastActivityTimestamp().then(function(){return r._replayQueuedOperations()}).then(function(){IOWA.Schedule.loadUserSchedule()})})["catch"](function(e){IOWA.Analytics.trackError("firebaseRef.authWithOAuthToken(...)",e),debugLog("Login to Firebase Failed!",e)})}},{key:"unAuth",value:function(){if(this.firebaseRef){var e=this.firebaseRef.getAuth().uid;this.firebaseRef.child("users/"+e+"/web_notifications_enabled").off(),this.firebaseRef.child("data/"+e+"/my_sessions").off(),this.firebaseRef.child("data/"+e+"/feedback_submitted_sessions").off(),this.firebaseRef.child("data/"+e+"/viewed_videos").off(),this.firebaseRef.unauth(),debugLog("Unauthorized Firebase"),this.firebaseRef=null}this.clearCachedReads(),this.clearCachedUpdates(),IOWA.Schedule.clearUserSchedule()}},{key:"_replayQueuedOperations",value:function(){var e=this,t={};return IOWA.SimpleDB.instance(IOWA.SimpleDB.NAMES.UPDATES).then(function(e){return e.forEach(function(e,n){t[e]=n})}).then(function(){return Promise.all(Object.keys(t).map(function(n){return e._setFirebaseData(n,t[n])}))}).then(function(e){e&&e.length&&IOWA.Elements.Toast.showMessage("My Schedule was updated with offline changes.")})["catch"](function(e){debugLog("Error in _replayQueuedOperations: "+e)})}},{key:"_setClockOffset",value:function(){var e=this,t=this.firebaseRef.child("/.info/serverTimeOffset");return t.once("value").then(function(t){e.clockOffset=t.val(),debugLog("Updated clockOffset to",e.clockOffset,"ms")})}},{key:"_bumpLastActivityTimestamp",value:function(){var e=this.firebaseRef.getAuth().uid;return this.firebaseRef.child("users/"+e+"/last_activity_timestamp").onDisconnect().set(Firebase.ServerValue.TIMESTAMP),this._setFirebaseUserData("users","last_activity_timestamp",Firebase.ServerValue.TIMESTAMP)}},{key:"registerToNotificationUpdates",value:function(e){var t=this,n=function(){var n=t.firebaseRef.getAuth().uid;t.firebaseRef.child("users/"+n+"/web_notifications_enabled").on("value",function(t){return e(t.val())})};this.isAuthed()&&n(),this.authCallbacks.push(n)}},{key:"registerToSessionUpdates",value:function(e){this._registerToUpdates("data","my_sessions",e)}},{key:"registerToFeedbackUpdates",value:function(e){this._registerToUpdates("data","feedback_submitted_sessions",e)}},{key:"registerToVideoWatchUpdates",value:function(e){this._registerToUpdates("data","viewed_videos",e)}},{key:"clearCachedReads",value:function(){return IOWA.SimpleDB.clearData(IOWA.SimpleDB.NAMES.READS)}},{key:"clearCachedUpdates",value:function(){return IOWA.SimpleDB.clearData(IOWA.SimpleDB.NAMES.UPDATES)}},{key:"replayCachedSavedSessions",value:function(e){return this._replayCachedData("my_sessions",e)}},{key:"replayCachedSessionFeedback",value:function(e){return this._replayCachedData("feedback_submitted_sessions",e)}},{key:"_replayCachedData",value:function(e,t){return IOWA.SimpleDB.instance(IOWA.SimpleDB.NAMES.READS).then(function(n){var r=new RegExp(e+".*?([^/]+)$");return n.forEach(function(e,n){if(n){var i=e.match(r);i&&t(i[1],n)}})})["catch"](function(e){debugLog("SimpleDB error while reading cache data:",e)})}},{key:"_registerToUpdates",value:function(e,t,n){var r=this;this.isAuthed()?!function(){var i=r.firebaseRef.getAuth().uid,a=r.firebaseRef.child(e+"/"+i+"/"+t),o=a.toString(),s=function(e,t){return IOWA.SimpleDB.instance(IOWA.SimpleDB.NAMES.READS).then(function(n){return n.set(o+"/"+e,t)})["catch"](function(e){debugLog("SimpleDB error in wrappedCallback:",e)}).then(function(){return n(e,t)})};a.on("child_added",function(e){s(e.key(),e.val())}),a.on("child_changed",function(e){s(e.key(),e.val())}),a.on("child_removed",function(e){s(e.key(),null)})}():debugLog("Trying to subscribe to Firebase while not authorized.")}},{key:"toggleSession",value:function(e,t){return this._setFirebaseUserData("data","my_sessions/"+e,{timestamp:Date.now()+this.clockOffset,in_schedule:t})}},{key:"markSessionRated",value:function(e){return this._setFirebaseUserData("data","feedback_submitted_sessions/"+e,!0)}},{key:"markVideoAsViewed",value:function(e){var t=e.match(/.*(?:youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=)([^#\&\?]*).*/),n=t?t[1]:e;return this._setFirebaseUserData("data","viewed_videos/"+n,!0)}},{key:"addPushSubscription",value:function(e){if(!(e instanceof PushSubscription))return Promise.reject("Tried to add invalid subscription details to Firebase");var t=crc32(e.endpoint),n=JSON.stringify(e);return this._setFirebaseUserData("users","web_push_subscriptions/"+t,n)}},{key:"setNotificationsEnabled",value:function(e){return this._setFirebaseUserData("users","web_notifications_enabled",!!e)}},{key:"_queueOperation",value:function(e,t){return IOWA.SimpleDB.instance(IOWA.SimpleDB.NAMES.UPDATES).then(function(n){return n.set(e,t)})["catch"](function(e){debugLog("Error in IOFirebase._queueOperation()",e)})}},{key:"_dequeueOperation",value:function(e){return IOWA.SimpleDB.instance(IOWA.SimpleDB.NAMES.UPDATES).then(function(t){return t["delete"](e)})["catch"](function(e){debugLog("Error in IOFirebase._dequeueOperation()",e)})}},{key:"_setFirebaseUserData",value:function(e,t,n){if(this.isAuthed()){var r=this.firebaseRef.getAuth().uid;return this._setFirebaseData(e+"/"+r+"/"+t,n)}if(IOWA.Elements.Template.app.currentUser&&IOWA.Elements.Template.app.currentUser.id){var i="google:"+IOWA.Elements.Template.app.currentUser.id;return this._queueOperation(e+"/"+i+"/"+t,n)}return Promise.reject("Not currently authorized with Firebase.")}},{key:"_setFirebaseData",value:function(e,t){var n=this,r=this.firebaseRef.child(e);return this._queueOperation(e,t).then(function(){return r.set(t)}).then(function(){return debugLog("Success: Firebase.set("+r+") with value "+JSON.stringify(t)),n._dequeueOperation(e)},function(i){return debugLog("Failure: Firebase.set("+r+") with value "+(JSON.stringify(t)+" failed due to "+i)),n._dequeueOperation(e).then(function(){return Promise.reject(i)})})}},{key:"isAuthed",value:function(){return this.firebaseRef&&this.firebaseRef.getAuth()}}],[{key:"_selectShard",value:function(e){var t=parseInt(crc32(e),16)%window.FIREBASE_SHARDS.length;return window.FIREBASE_SHARDS[t]}},{key:"goOffline",value:function(){Firebase.goOffline(),debugLog("Firebase went offline.")}},{key:"goOnline",value:function(){Firebase.goOnline(),debugLog("Firebase back online!")}}]),e}();IOWA.IOFirebase=IOWA.IOFirebase||new IOFirebase,window.IOWA=window.IOWA||{},IOWA.A11y=IOWA.A11y||function(){function e(){t(".io-logo-link"),t("#navbar paper-tabs a"),t("#signin-nav-elements .button-link"),document.addEventListener("toast-message",r),document.addEventListener("page-transition-done",i),document.addEventListener("app-drawer-transitioned",a.bind(this)),this._drawerAnchor=IOWA.Elements.Drawer.querySelector("a")}function t(e){var t=document.querySelectorAll(e);Array.prototype.forEach.call(t,function(e){e.addEventListener("mousedown",s),e.addEventListener("mouseup",c),e.addEventListener("focus",u),e.addEventListener("blur",l)})}function n(e){var t=document.querySelectorAll(e);Array.prototype.forEach.call(t,function(e){e.removeEventListener("mousedown",s),e.removeEventListener("mouseup",c),e.removeEventListener("focus",u),e.removeEventListener("blur",l)})}function r(e){setTimeout(function(){IOWA.Elements.LiveStatus.textContent="Notification: "+e.detail.message},1e3)}function i(){if(o){o=!1;var e=IOWA.Elements.NavPaperTabs.querySelector('paper-tab[tabindex="0"]');return void(e&&e.setAttribute("tabindex","-1"))}var t=IOWA.Elements.LazyPages.selectedPage;t.manageFocus()}function a(){IOWA.Elements.Drawer.opened&&this._drawerAnchor.focus()}var o=!0,s=function(){this.classList.add("pressed"),this.focus()},c=function(){this.classList.remove("pressed")},u=function(){this.classList.contains("pressed")||this.classList.add("focused")},l=function(){this.classList.remove("focused")};return{init:e,addFocusStates:t,removeFocusStates:n,announceLiveChange:r,focusNewPage:i,focusDrawer:a}}(),IOWA.ServiceWorkerRegistration=function(){var e=!1,t="service-worker.js",n="./",r=function(){e||(e=!0,"serviceWorker"in navigator&&navigator.serviceWorker.register(t,{scope:n}).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){switch(t.state){case"installed":navigator.serviceWorker.controller||IOWA.Elements.Toast.showMessage("Caching complete! Future visits will work offline.");break;case"redundant":throw Error("The installing service worker became redundant.")}}}})["catch"](function(e){IOWA.Analytics.trackError("navigator.serviceWorker.register() error",e),console.error("Service worker registration failed:",e)}))};return navigator.serviceWorker&&navigator.serviceWorker.controller&&(navigator.serviceWorker.controller.onstatechange=function(e){if("redundant"===e.target.state){var t=function(){window.location.reload()};IOWA.Elements.Toast.showMessage("Tap here or refresh the page for the latest content.",t)}}),{register:r,URL:t,SCOPE:n}}(),IOWA.Router_=function(e){var t=function(){};return t.prototype.state={start:null,current:null,end:null},t.prototype.init=function(t){this.t=t,this.state.current=this.parseUrl(e.location.href),e.addEventListener("popstate",function(){this.navigate(e.location.href,"page-slide-transition")}.bind(this)),document.addEventListener("click",this.onClick.bind(this))},t.prototype.onClick=function(e){if(!e.metaKey&&!e.ctrlKey){var t=IOWA.Util.getEventSender(e,"a");if(t){if(t.hasAttribute(this.t.app.ANALYTICS_LINK_ATTR)&&IOWA.Analytics.trackEvent("link","click",t.getAttribute(this.t.app.ANALYTICS_LINK_ATTR)),t.target)return;if("smooth-scroll"===t.getAttribute("data-transition"))return void e.preventDefault();t.hasAttribute("data-ajax-link")&&(e.preventDefault(),e.stopPropagation(),this.navigate(t.href,e,t))}}},t.pageExitTransitions={"hero-card-transition":"playHeroTransitionStart","page-slide-transition":"playPageSlideOut"},t.pageEnterTransitions={"hero-card-transition":"playHeroTransitionEnd","page-slide-transition":"playPageSlideIn"},t.prototype.runPageHandler=function(e,t){return new Promise(function(n){t&&t[e]&&t[e](),n()})},t.prototype.updateUIstate=function(){var t=IOWA.Elements.Main.querySelectorAll(".subpage__content"),n=IOWA.Elements.Main.querySelector(".subpage-"+this.state.current.subpage);if(n){Array.prototype.forEach.call(t,function(e){e.style.display="none"}),n.style.display="";var r=IOWA.Elements.LazyPages.selectedPage;r.selectedSubpage=this.state.current.subpage}this.state.current.href!==e.location.href&&(history.pushState({path:this.state.current.path+this.state.current.hash},"",this.state.current.href),
IOWA.Analytics.trackPageView(location.pathname+location.hash))},t.prototype.runPageTransition=function(e,n){var r=n?n.getAttribute("data-transition"):null,i=r||"page-slide-transition",a=this;a.t.fire("page-transition-start");var o=IOWA.PageAnimation[t.pageExitTransitions[i]],s=IOWA.PageAnimation[t.pageEnterTransitions[i]];o(a.state.start.page,a.state.end.page,e,n).then(function(){return IOWA.Elements.LazyPages.selected=a.state.end.page,new Promise(function(e){a.t.async(e)})}).then(function(){a.state.current=a.parseUrl(a.state.end.href),a.updateUIstate()}).then(s).then(function(){a.t.fire("page-transition-done")})["catch"](function(e){console.error(e),IOWA.Util.reportError(e)})},t.prototype.runSubpageTransition=function(){var e=IOWA.Elements.Main.querySelector(".subpage-"+this.state.start.subpage),t=IOWA.Elements.Main.querySelector(".subpage-"+this.state.end.subpage),n=this;e&&t&&IOWA.PageAnimation.playSectionSlideOut(e).then(function(){n.state.current=n.parseUrl(n.state.end.href);var e=IOWA.Elements.LazyPages.selectedPage;if(e.hasSubnav){var t=n.t.$.header.shadow;t||n.t.set("app.headerReveals",!1),e.scrollToTopOfSubContainer()}return n.updateUIstate()}).then(IOWA.PageAnimation.playSectionSlideIn.bind(null,t)).then(function(){n.runPageHandler("onSubpageTransitionDone",IOWA.Elements.LazyPages.selectedPage)})},t.prototype.navigate=function(e,t,n){this.state.start=this.parseUrl(this.state.current.href),this.state.end=this.parseUrl(e),this.state.start.page!==this.state.end.page?(this.t.selectedPage=this.state.end.page,this.runPageTransition(t,n)):this.state.start.subpage!==this.state.end.subpage&&this.runSubpageTransition()},t.prototype.parseUrl=function(t){var n=new URL(t),r=n.hash.replace("#","").split("/"),i={};if(n.search)for(var a=n.search.replace("?","").split("&"),o=0;o<a.length;o++){var s=a[o].split("=");i[s[0]]=decodeURIComponent(s[1])}var c=n.pathname.replace(e.PREFIX+"/","")||"home",u=this.t&&this.t.pages?this.t.pages[c]:null,l=u?u.defaultSubpage:"",d=r[0]||l;return{pathname:n.pathname,search:n.search,hash:n.hash,href:n.href,page:c,subpage:d,resourceId:r[1],params:i}},t.prototype.composeUrl=function(t,n,r,i){return[e.location.origin,e.PREFIX,"/",t,i,"#",n||"","/",r||""].join("")},new t},self.IOWA=self.IOWA||{},IOWA.Request=IOWA.Request||function(){function e(e,t){t&&e.setRequestHeader("Authorization",t.token_type+" "+t.access_token)}var t=function(t,n,r,i){var a;if(i&&(a=IOWA.Auth.getTokenResponse(),!a))return void r();var o,s=!0;if("serviceWorker"in navigator&&navigator.serviceWorker.controller){var c=new XMLHttpRequest;c.open("GET",t),e(c,a),c.setRequestHeader("X-Cache-Only","true"),c.onload=function(){this.status<400&&s&&this.response&&(o=this.response,n(JSON.parse(o)))},c.send()}var u=new XMLHttpRequest;u.open("GET",t),e(u,a),u.setRequestHeader("X-Cache-Only","false"),u.onload=function(){this.status<400&&this.response!==o&&(s=!1,r(JSON.parse(this.response)))},u.send()},n=function(t,n,r,i){return new Promise(function(a,o){var s;if(r&&(s=IOWA.Auth.getTokenResponse(),!s))throw Error(t+" "+n+" failed; not logged in.");var c=new XMLHttpRequest;c.open(t,n),c.setRequestHeader("Content-Type","application/json"),e(c,s),c.onerror=o,c.onload=function(){if(this.status<400){var e={};try{e=JSON.parse(this.response)}catch(r){}a(e)}else o(Error(t+" "+n+" failed with status "+this.statusText))},c.send(i?JSON.stringify(i):null)})};return{cacheThenNetwork:t,xhrPromise:n}}(),window.IOWA=window.IOWA||{},IOWA.Picasa=function(){function e(e){return"https://picasaweb.google.com/data/feed/api/user/"+i+"/albumid/"+e+"?alt=jsonc&kind=photo&hl="+s+"&imgmax="+Math.min(parseInt(c*(window.devicePixelRatio||1),10),1440)+"&max-results=5000&v=2"}function t(t,n,i){var o=t||1,s=e(i||a),c=r+"?url="+encodeURIComponent(s+"&start-index="+o),u=new XMLHttpRequest;u.open("GET",c),u.onload=function(){if(200===this.status){var e=JSON.parse(this.response).data.items;n(e)}},u.send()}function n(e){return t(null,e,o)}var r="api/v1/photoproxy",i="111395306401981598462",a="6148448302499535601",o="6151106494033928993",s=document.documentElement.lang,c=document.documentElement.clientWidth;return{fetchPhotos:t,fetchExtendedPhotos:n}}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),SimpleDB=function(){function e(){_classCallCheck(this,e),this.simpleDbInstances={},this.NAMES={READS:"firebase-reads",UPDATES:"firebase-updates",USER:"user-info"}}return _createClass(e,[{key:"instance",value:function(e){var t=this;return window.indexedDB&&window.indexedDB.open&&window.simpleDB?this.simpleDbInstances[e]?Promise.resolve(this.simpleDbInstances[e]):window.simpleDB.open(e).then(function(n){return t.simpleDbInstances[e]=n,t.simpleDbInstances[e]}):Promise.reject("SimpleDB is not supported.")}},{key:"clearData",value:function(e){return this.instance(e).then(function(e){return e.clear()})}}]),e}();window.IOWA=window.IOWA||{},IOWA.SimpleDB=IOWA.SimpleDB||new SimpleDB;var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();self.IOWA=self.IOWA||{};var Schedule=function(){function e(){_classCallCheck(this,e),this.scheduleData_=null,this.cache={userSavedSessions:[],userSavedSurveys:[]},this.scheduleDeferredPromise=null,this.scheduleDeferredPromiseResolver=null}return _createClass(e,[{key:"QUEUED_SESSION_API_UPDATES_DB_NAME",get:function(){return"toolbox-offline-session-updates"}},{key:"SCHEDULE_ENDPOINT",get:function(){return"api/v1/schedule"}},{key:"SURVEY_ENDPOINT",get:function(){return"api/v1/user/survey"}}]),_createClass(e,[{key:"createScheduleDeferred_",value:function(){var e=this,t=IOWA.Util.createDeferred();this.scheduleDeferredPromiseResolver=t.resolve,this.scheduleDeferredPromise=t.promise.then(function(t){e.scheduleData_=t.scheduleData;var n=IOWA.Elements.Template;return n.domStampedPromise.then(function(){n.set("app.scheduleData",t.scheduleData),n.set("app.filterSessionTypes",t.tags.filterSessionTypes),n.set("app.filterThemes",t.tags.filterThemes),n.set("app.filterTopics",t.tags.filterTopics)}),e.scheduleData_})}},{key:"fetchSchedule",value:function(){var e=this;return this.scheduleData_?Promise.resolve(this.scheduleData_):IOWA.Request.xhrPromise("GET",this.SCHEDULE_ENDPOINT,!1).then(function(t){return e.scheduleData_=t,e.scheduleData_})}},{key:"schedulePromise",value:function(){return this.scheduleDeferredPromise||this.createScheduleDeferred_(),this.scheduleDeferredPromise}},{key:"resolveSchedulePromise",value:function(e){this.scheduleDeferredPromiseResolver||this.createScheduleDeferred_(),this.scheduleDeferredPromiseResolver(e)}},{key:"fetchResource",value:function(e,t,n){var r=this;if(this.cache[t].length)n(this.cache[t]);else{var i=function(e){r.cache[t]=e||[],n(r.cache[t])};IOWA.Request.cacheThenNetwork(e,n,i,!0)}}},{key:"loadUserSchedule",value:function(){this._loadUserSchedule(!1)}},{key:"loadCachedUserSchedule",value:function(){this._loadUserSchedule(!0)}},{key:"_loadUserSchedule",value:function(e){var t=function(e,t){var n=IOWA.Elements.Template,r=n.app.savedSessions,i=r.indexOf(e),a=n.app.scheduleData.sessions.findIndex(function(t){return t.id===e});t&&t.in_schedule&&-1===r.indexOf(e)?(n.push("app.savedSessions",e),n.set("app.scheduleData.sessions."+a+".saved",!0),debugLog("Session "+e+" bookmarked!")):t&&!t.in_schedule&&-1!==i&&(n.splice("app.savedSessions",i,1),n.set("app.scheduleData.sessions."+a+".saved",!1),debugLog("Session "+e+" removed from bookmarks!"))},n=function(e){var t=IOWA.Elements.Template,n=t.app.savedSurveys,r=t.app.scheduleData.sessions.findIndex(function(t){return t.id===e});-1===n.indexOf(e)&&(t.push("app.savedSurveys",e),t.set("app.scheduleData.sessions."+r+".rated",!0),debugLog("Session "+e+" has received feedback!"))},r=function(e){var t=IOWA.Elements.Template,n=t.app.watchedVideos,r=t.app.scheduleData.sessions,i=r.findIndex(function(t){return t.youtubeUrl&&t.youtubeUrl.match(e)});-1===n.indexOf(e)&&(t.push("app.watchedVideos",e),t.set("app.scheduleData.sessions."+i+".watched",!0),debugLog("Session "+e+" video has been watched."))};this.schedulePromise().then(function(){e?(IOWA.IOFirebase.replayCachedSavedSessions(t),IOWA.IOFirebase.replayCachedSessionFeedback(n)):IOWA.IOFirebase.clearCachedReads().then(function(){IOWA.IOFirebase.registerToSessionUpdates(t),IOWA.IOFirebase.registerToFeedbackUpdates(n),IOWA.IOFirebase.registerToVideoWatchUpdates(r)})})}},{key:"saveSession",value:function(e,t){return IOWA.Analytics.trackEvent("session","bookmark",t?"save":"remove"),IOWA.Auth.waitForSignedIn("Sign in to add events to My Schedule",!0).then(function(){return IOWA.IOFirebase.toggleSession(e,t)["catch"](function(e){return IOWA.Elements.Toast.showMessage(e+" The change will be retried on your next visit.")})})}},{key:"submitSessionRequest",value:function(e,t,n,r,i){return IOWA.Request.xhrPromise(t,e,!0,n).then(i.bind(this))["catch"](function(e){throw"serviceWorker"in navigator&&XMLHttpRequestProgressEvent&&e instanceof XMLHttpRequestProgressEvent?IOWA.Elements.Toast.showMessage(r+" The change will be retried on your next visit."):IOWA.Elements.Toast.showMessage(r),e})}},{key:"saveSurvey",value:function(e,t){var n=this;return IOWA.Analytics.trackEvent("session","rate",e),IOWA.Auth.waitForSignedIn("Sign in to submit feedback").then(function(){var r=n.SURVEY_ENDPOINT+"/"+e,i=function(t){IOWA.Elements.Template.set("app.savedSurveys",t),IOWA.IOFirebase.markSessionRated(e)};return n.submitSessionRequest(r,"PUT",t,"Unable to save feedback results.",i)})}},{key:"bookmarkSessionNotification",value:function(e,t){var n=t||"You'll get a notification when it starts.",r=document.querySelector("io-notification-widget");if(r){if(e)return r.subscribeIfAble().then(function(e){e?IOWA.Elements.Toast.showMessage("Added to My Schedule. "+n):"denied"===Notification.permission?IOWA.Elements.Toast.showMessage("Added to My Schedule. Want to enable notifications?",null,"Learn how",function(){return window.open("permissions","_blank")}):IOWA.Elements.Toast.showMessage("Added to My Schedule.")});IOWA.Elements.Toast.showMessage("Removed from My Schedule")}else IOWA.Elements.Toast.showMessage("My Schedule update queued. Reload this page while online to apply it.")}},{key:"generateFilters",value:function(){for(var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=[],n=[],r=[],i=Object.keys(e).map(function(t){return e[t]}).sort(function(e,t){return e.order_in_category<t.order_in_category?-1:e.order_in_category>t.order_in_category?1:0}),a=0;a<i.length;++a){var o=i[a];switch(o.category){case"TYPE":t.push(o.name);break;case"TRACK":r.push(o.name);break;case"THEME":n.push(o.name)}}return{filterSessionTypes:t,filterThemes:n,filterTopics:r}}},{key:"updateSavedSessionsUI_",value:function(e){for(var t=IOWA.Elements.Template,n=t.app.scheduleData.sessions,r=0;r<n.length;++r){var i=-1!==e.indexOf(n[r].id);t.set("app.scheduleData.sessions."+r+".saved",i)}}},{key:"clearUserSchedule",value:function(){var e=IOWA.Elements.Template;e.set("app.savedSessions",[]),this.updateSavedSessionsUI_(e.app.savedSessions),this.clearCachedUserSchedule()}},{key:"clearCachedUserSchedule",value:function(){this.cache.userSavedSessions=[]}},{key:"getSessionById",value:function(e){for(var t=0;t<this.scheduleData_.sessions.length;++t){var n=this.scheduleData_.sessions[t];if(n.id===e)return n}return null}}]),e}();IOWA.Schedule=IOWA.Schedule||new Schedule,function(){function e(){s.forEach(function(e){var t=e.reason;return IOWA.Analytics.trackError("UnhandledPromiseRejection",t)}),s=[],a=null}function t(){var e,t=1e4,n=window.performance&&window.performance.now;if(n){var r=window.performance.now();e=new Worker("data-worker-scripts.js");var i=window.performance.now()-r;debugLog("worker startup:",i,"ms"),IOWA.Analytics.trackPerf("worker","creation",Math.ceil(i),null,t)}else e=new Worker("data-worker-scripts.js");var a;n&&(a=window.performance.now()),e.addEventListener("message",function(e){if(e.data){var r=e.data;if(r.scheduleData){if(n){var i=window.performance.now()-a;debugLog("worker fetch:",i,"ms"),IOWA.Analytics.trackPerf("worker","data fetch",Math.ceil(i),null,t)}IOWA.Schedule.resolveSchedulePromise(r)}}}),e.postMessage({cmd:"FETCH_SCHEDULE"})}function n(){var e=function(){window.HTMLImports||document.dispatchEvent(new CustomEvent("WebComponentsReady",{bubbles:!0}))},t="registerElement"in document&&"import"in document.createElement("link")&&"content"in document.createElement("template");if(t)e();else{var n=document.createElement("script");n.async=!0,n.src="bower_components/webcomponentsjs/webcomponents-lite.min.js",n.onload=e,document.head.appendChild(n)}}function r(){var e=document.getElementById("splash");e.addEventListener("transitionend",function(){e.parentElement.removeChild(e)}),document.body.classList.remove("loading")}function i(){t(),Polymer.Base.importHref("https://events.google.com/io2016/elements/elements.html",function(){IOWA.Elements.onElementsBundleLoaded(),IOWA.Notifications&&!IOWA.Notifications.supported&&document.body.classList.add("nosupport-notifications"),r();var e=IOWA.Util.getFPIfSupported();e&&(debugLog("first paint:",e,"ms"),IOWA.Analytics.trackPerf("load","firstpaint",e))},null,!0),IOWA.Router=IOWA.Router_(window),IOWA.Elements.init(),IOWA.Router.init(IOWA.Elements.Template),IOWA.Schedule.loadCachedUserSchedule()}var a,o=1e4,s=[];window.addEventListener("unhandledrejection",function(t){debugLog("unhandledrejection fired: "+t.reason),s.push({promise:t.promise,reason:t.reason}),a||(a=setTimeout(e,o))}),window.addEventListener("rejectionhandled",function(e){debugLog("rejectionhandled fired: "+e.reason),s=s.filter(function(t){return t.promise!==e.promise})}),window.addEventListener("keydown",function(e){if(27===e.keyCode){var t=document.querySelector("io-schedule-subnav");t&&t.closeFilters();var n=document.querySelector("io-live");n&&(n.openWidget=!1)}}),window.addEventListener("resize",function(){IOWA.Elements&&IOWA.Elements.Template&&IOWA.Elements.Template.debounce("resize",function(){this.closeDrawer(),this.initFabScroll()},400)}),window.addEventListener("offline",function(){IOWA.Elements&&IOWA.Elements.Toast&&IOWA.Elements.Toast.showMessage("Offline. Changes you make to My Schedule will be saved for later.")}),n(),IOWA.Util.supportsHTMLImports?i():document.addEventListener("HTMLImportsLoaded",i),window.addEventListener("beforeinstallprompt",function(e){IOWA.Analytics.trackEvent("installprompt","fired"),e.userChoice.then(function(e){IOWA.Analytics.trackEvent("installprompt",e.outcome,e.platform)})})}();
